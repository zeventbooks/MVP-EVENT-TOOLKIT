{
  "$schema": "./schemas/deploy-manifest.schema.json",
  "_comment": "Centralized Deployment Manifest - Single Source of Truth for Environment Configuration",
  "_version": "2.0.0",
  "_lastUpdated": "2025-12-13",
  "_story": "Story 5.3: Decommission Apps Script Project",
  "_architecture": "Worker-only (GAS backend archived)",

  "environments": {
    "staging": {
      "name": "Staging",
      "description": "Safe sandbox for testing and pre-production validation - Cloudflare Worker only",

      "appsScript": {
        "_status": "ARCHIVED",
        "_archivedDate": "2025-12-13",
        "_story": "Story 5.3: Decommission Apps Script Project",
        "_note": "GAS backend has been archived. All traffic now served by Cloudflare Workers. See archive/gas/README.md for restoration instructions.",
        "scriptId": "1gHiPuj7eXNk09dDyk17SJ6QsCJg7LMqXBRrkowljL3z2TaAKFIvBLhHJ",
        "deploymentId": "AKfycbwFneYCpkio7wCn7y08eDUb2PRCPc2Tdtbv20L4AbEHvuCvoqY9ks7-ONL0pzPPw4Hm",
        "webAppUrl": "https://script.google.com/macros/s/AKfycbwFneYCpkio7wCn7y08eDUb2PRCPc2Tdtbv20L4AbEHvuCvoqY9ks7-ONL0pzPPw4Hm/exec",
        "editUrl": "https://script.google.com/u/1/home/projects/1gHiPuj7eXNk09dDyk17SJ6QsCJg7LMqXBRrkowljL3z2TaAKFIvBLhHJ/edit"
      },

      "cloudflare": {
        "workerName": "eventangle-staging",
        "routes": [
          "stg.eventangle.com/*",
          "api-stg.eventangle.com/*"
        ],
        "zoneName": "eventangle.com",
        "_note": "Primary backend - all traffic served by Cloudflare Worker"
      },

      "urls": {
        "baseUrl": "https://stg.eventangle.com",
        "apiUrl": "https://api-stg.eventangle.com"
      },

      "flags": {
        "workerEnv": "staging",
        "debugLevel": "debug",
        "enableDebugEndpoints": true
      },

      "featureFlags": {
        "_comment": "Feature flags for staging: testing features ON by default, production features match prod",

        "mvpFeatures": {
          "_comment": "Core MVP features - must match production (always enabled)",
          "EVENTS": true,
          "SPONSORS": true,
          "ANALYTICS": true,
          "FORMS": true,
          "SHORTLINKS": true,
          "PORTFOLIO_ANALYTICS": true
        },

        "testingFeatures": {
          "_comment": "Testing/development features - ON in staging, OFF in production",
          "DEMO_MODE_ENABLED": true,
          "DEBUG_PANEL": true,
          "API_TIMING_LOGS": true,
          "ERROR_DETAILS": true,
          "SAMPLE_DATA_PREFILL": true,
          "FEATURE_HIGHLIGHTING": true,
          "CONSOLE_LOGGING": true
        },

        "v2Features": {
          "_comment": "V2 deferred features - OFF in both environments until explicitly enabled",
          "TEMPLATE_MANAGEMENT_V2": false,
          "PORTFOLIO_V2": false
        },

        "experimentalFeatures": {
          "_comment": "Experimental features for staging validation only - OFF in production",
          "NEW_UI_COMPONENTS": true,
          "ENHANCED_VALIDATION": true,
          "PERFORMANCE_MONITORING": true
        }
      }
    },

    "production": {
      "name": "Production",
      "description": "Customer-facing production environment - Cloudflare Worker only",

      "appsScript": {
        "_status": "ARCHIVED",
        "_archivedDate": "2025-12-13",
        "_story": "Story 5.3: Decommission Apps Script Project",
        "_note": "GAS backend has been archived. All traffic now served by Cloudflare Workers. See archive/gas/README.md for restoration instructions.",
        "scriptId": "1YO4apLOQoAIh208AcAqWO3pWtx_O3yas_QC4z-pkurgMem9UgYOsp86l",
        "deploymentId": "AKfycbz-RVTCdsQsI913wN3TkPtUP8F8EhSjyFAlWIpLVRgzV6WJ-isDyG-ntaV1VjBNaWZLdw",
        "webAppUrl": "https://script.google.com/macros/s/AKfycbz-RVTCdsQsI913wN3TkPtUP8F8EhSjyFAlWIpLVRgzV6WJ-isDyG-ntaV1VjBNaWZLdw/exec",
        "editUrl": "https://script.google.com/u/1/home/projects/1YO4apLOQoAIh208AcAqWO3pWtx_O3yas_QC4z-pkurgMem9UgYOsp86l/edit"
      },

      "cloudflare": {
        "workerName": "eventangle-prod",
        "routes": [
          "eventangle.com/*",
          "www.eventangle.com/*",
          "api.eventangle.com/*"
        ],
        "zoneName": "eventangle.com",
        "_note": "Primary backend - all traffic served by Cloudflare Worker"
      },

      "urls": {
        "baseUrl": "https://www.eventangle.com",
        "apiUrl": "https://api.eventangle.com"
      },

      "flags": {
        "workerEnv": "production",
        "debugLevel": "error",
        "enableDebugEndpoints": false
      },

      "featureFlags": {
        "_comment": "Feature flags for production: conservative defaults, testing features OFF",

        "mvpFeatures": {
          "_comment": "Core MVP features - always enabled in production",
          "EVENTS": true,
          "SPONSORS": true,
          "ANALYTICS": true,
          "FORMS": true,
          "SHORTLINKS": true,
          "PORTFOLIO_ANALYTICS": true
        },

        "testingFeatures": {
          "_comment": "Testing/development features - OFF in production for security and performance",
          "DEMO_MODE_ENABLED": false,
          "DEBUG_PANEL": false,
          "API_TIMING_LOGS": false,
          "ERROR_DETAILS": false,
          "SAMPLE_DATA_PREFILL": false,
          "FEATURE_HIGHLIGHTING": false,
          "CONSOLE_LOGGING": false
        },

        "v2Features": {
          "_comment": "V2 deferred features - OFF until explicitly approved for production release",
          "TEMPLATE_MANAGEMENT_V2": false,
          "PORTFOLIO_V2": false
        },

        "experimentalFeatures": {
          "_comment": "Experimental features - always OFF in production",
          "NEW_UI_COMPONENTS": false,
          "ENHANCED_VALIDATION": false,
          "PERFORMANCE_MONITORING": false
        }
      }
    }
  },

  "defaults": {
    "testEnvironment": "staging",
    "deploymentBranch": "main",
    "tagPattern": "v*.*.*"
  },

  "brands": {
    "_comment": "Brand-specific URLs follow pattern: {baseUrl}/{brandId}/{page}",
    "validBrands": ["root", "abc", "cbc", "cbl"],
    "defaultBrand": "root"
  },

  "validation": {
    "scriptIdPattern": "^[a-zA-Z0-9_-]{40,60}$",
    "deploymentIdPattern": "^AKfycb[a-zA-Z0-9_-]+$",
    "deploymentIdMinLength": 50
  },

  "gasRetirement": {
    "_comment": "Story 5.3: GAS backend retirement tracking",
    "status": "ARCHIVED",
    "archivedDate": "2025-12-13",
    "archiveLocation": "archive/gas/",
    "restorationGuide": "archive/gas/README.md",
    "reason": "Migration to Cloudflare Workers complete - all APIs now Worker-native"
  }
}
