<!--
================================================================================
MVP SURFACE - Focus Group Critical
================================================================================
Page: Display.html
Purpose: TV/kiosk display for live event streaming with sponsor visibility
Status: LOCKED for MVP v1.0

DO NOT modify this file's contracts without updating:
  - NUSDK.html (API client)
  - tests/e2e/* (end-to-end tests)
  - tests/unit/* (unit tests)

Related MVP Surfaces: Admin, Poster, Public, Sponsor, SharedReport
================================================================================
-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title><?= appTitle ?> Â· TV Display</title>
  <?!= include('Styles'); ?>
  <?!= include('SponsorUtils'); ?>
  <?!= include('SharedUtils'); ?>
  <?!= include('FooterComponent'); ?>
  <?!= include('NUSDK'); ?>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="referrer" content="no-referrer" />
  <style>
    :root {
      --tv-pad: 12px;
      --side-w: 320px;
      /* TV overscan safe area - 5% margins for older TVs */
      --tv-safe-area: 5%;
    }
    body[data-tv="1"] {
      background: var(--color-tv-bg, #111);
      color: var(--color-tv-text, #eee);
      font-size: clamp(20px, 2.8vw, 32px); /* Legible at 10-12ft */
      line-height:1.5;
      /* Apply safe area padding for TV overscan */
      padding: var(--tv-safe-area);
      box-sizing: border-box;
    }
    [hidden] { display:none !important; }
    main#tv {
      display:grid; grid-template-columns: 1fr; grid-template-rows: auto 1fr; height:100vh;
    }
    main#tv.has-side {
      grid-template-columns: 1fr var(--side-w); grid-template-rows: auto 1fr;
    }
    .sponsor-top {
      grid-column: 1 / -1; grid-row:1;
      padding: var(--tv-pad); text-align:center; font-weight:600; opacity:.98;
      background: linear-gradient(135deg, var(--color-tv-bg, #0b0b0b) 0%, var(--color-tv-bg-elevated, #1a1a1a) 100%);
      border-bottom: 2px solid var(--color-tv-border, #333);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 24px;
      flex-wrap: wrap;
      min-height: 80px;
    }
    .sponsor-top img {
      max-height: var(--display-sponsor-logo-height-top, 72px); vertical-align:middle; margin:0 1rem;
      filter: brightness(1.1);
      transition: transform var(--transition-slow, 0.3s ease);
    }
    .sponsor-top img:hover {
      transform: scale(1.05);
    }
    .stage { position:relative; grid-column:1; grid-row:2; }
    iframe#stage {
      position:absolute; inset:0; width:100%; height:100%; border:0;
      background: var(--color-tv-bg, #000);
    }
    .fallback-card {
      position:absolute; inset:0; display:flex; flex-direction:column;
      align-items:center; justify-content:center;
      background: linear-gradient(135deg, var(--color-tv-bg-elevated, #1a1a1a) 0%, var(--color-tv-bg, #0f0f0f) 100%);
      text-align:center; padding:40px;
    }
    .fallback-card h2 {
      margin:0 0 16px; color: var(--color-warning, #f59e0b); font-size:2em;
      text-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
    }
    .fallback-card p { color: var(--color-tv-text-muted, #9ca3af); font-size:1.2em; margin:8px 0; line-height: 1.6; }
    aside#sponsorSide {
      grid-column:2; grid-row:2; padding: var(--tv-pad); overflow:auto;
      background: linear-gradient(180deg, var(--color-tv-bg, #0b0b0b) 0%, var(--color-tv-bg-elevated, #161616) 100%);
      display:flex; flex-direction:column; gap:16px;
      border-left: 2px solid var(--color-tv-border, #333);
    }
    .sp-card {
      display:flex; align-items:center; gap:12px;
      background: var(--color-tv-bg-card, #1f1f1f);
      padding:16px; border-radius:12px;
      border: 1px solid var(--color-tv-border, #2a2a2a);
      transition: all 0.3s ease;
    }
    .sp-card:hover {
      background: var(--color-tv-bg-elevated, #252525);
      transform: translateX(-4px);
      border-color: var(--color-tv-border-hover, #3a3a3a);
    }
    .sp-card img {
      max-height: var(--display-sponsor-logo-height-side, 64px); max-width:160px; object-fit:contain;
      filter: brightness(1.15);
    }
    /* TV-005: Sponsor name legibility for TV distance */
    .sp-name { font-weight:600; font-size: clamp(1.125rem, 2vw, 1.5rem); color: var(--color-tv-text, #f0f0f0); }
    .toast {
      position:fixed; right:20px; bottom:20px;
      background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.95) 100%);
      color:#fff; padding:12px 20px; border-radius:12px;
      font-size:.9em; z-index:999;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      backdrop-filter: blur(8px);
    }

    /* TV Mode Focus Indicators - for D-pad/remote navigation */
    body[data-tv="1"] a:focus-visible,
    body[data-tv="1"] button:focus-visible,
    body[data-tv="1"] [tabindex]:focus-visible {
      outline: 4px solid #ffb84d;
      outline-offset: 4px;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(255, 184, 77, 0.5);
    }

    /* Sponsor logo sizing for TV legibility */
    body[data-tv="1"] .sponsor-top img {
      max-height: clamp(var(--display-sponsor-logo-height-top, 72px), 10vw, var(--sponsor-logo-height-tv, 120px));
      filter: brightness(1.3) contrast(1.1);
    }

    /* .site-footer - Now centralized in FooterComponent.html (D-005) */
    /* TV mode styling handled by body[data-tv="1"] .site-footer selector */

    /* === League & Broadcast Strip (TV-optimized, bottom strip) === */
    .league-broadcast-strip {
      position: fixed;
      bottom: 32px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(12px);
      border-radius: 16px;
      padding: 12px 24px;
      z-index: 50;
      border: 1px solid rgba(255, 255, 255, 0.15);
      display: flex;
      align-items: center;
      gap: 20px;
      max-width: 90vw;
    }
    /* TV-optimized strip text sizes (10-12ft viewing distance) */
    /* Fixed: TV-001, TV-002, TV-003 - text was illegible at TV distance */
    .league-broadcast-strip .strip-title {
      color: var(--color-warning, #f59e0b);
      font-size: clamp(1rem, 1.8vw, 1.5rem);  /* 16-24px for TV legibility */
      text-transform: uppercase;
      letter-spacing: 1px;
      white-space: nowrap;
      font-weight: 600;
    }
    .league-broadcast-strip .strip-divider {
      width: 2px;
      height: 28px;
      background: rgba(255, 255, 255, 0.25);
    }
    .league-broadcast-strip .strip-section {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .league-broadcast-strip .strip-label {
      color: #9ca3af;
      font-size: clamp(0.875rem, 1.5vw, 1.25rem);  /* 14-20px minimum */
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .league-broadcast-strip .strip-links {
      display: flex;
      gap: 12px;
    }
    .league-broadcast-strip .strip-link {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #fff;
      text-decoration: none;
      padding: 10px 16px;  /* Larger touch/remote targets */
      background: rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      font-size: clamp(1rem, 2vw, 1.5rem);  /* 16-24px for TV */
      transition: all 0.2s ease;
      white-space: nowrap;
    }
    .league-broadcast-strip .strip-link:hover {
      background: rgba(255, 255, 255, 0.15);
    }
    .league-broadcast-strip .strip-link .icon {
      font-size: 1rem;
    }
    .league-broadcast-strip .strip-link.stream-link {
      background: rgba(239, 68, 68, 0.3);
      color: #fca5a5;
    }
    .league-broadcast-strip .strip-link.stream-link:hover {
      background: rgba(239, 68, 68, 0.5);
    }

    /* Legacy overlay support (fallback/side column option) */
    .league-info-overlay {
      position: fixed;
      bottom: 40px;
      right: 20px;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      border-radius: 16px;
      padding: 20px 24px;
      z-index: 50;
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 320px;
    }
    .league-info-overlay h3 {
      color: #f59e0b;
      font-size: 1rem;
      margin: 0 0 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .league-info-overlay .league-links {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .league-info-overlay .league-link {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #eee;
      text-decoration: none;
      padding: 10px 14px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      font-size: 0.9em;
      transition: all 0.2s ease;
    }
    .league-info-overlay .league-link:hover {
      background: rgba(255, 255, 255, 0.12);
      transform: translateX(4px);
    }
    .league-info-overlay .league-link .icon {
      font-size: 1.2em;
    }

    /* === MVP Essential: Error State (TV-themed) === */
    .error-state-tv {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
      text-align: center;
      padding: 40px;
    }
    .error-state-tv .error-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.7;
    }
    .error-state-tv h2 {
      color: #ef4444;
      font-size: 1.8em;
      margin-bottom: 12px;
    }
    .error-state-tv p {
      color: #9ca3af;
      font-size: 1.1em;
      margin: 8px 0;
      max-width: 500px;
    }
    .error-state-tv .btn-retry {
      margin-top: 24px;
      padding: 14px 28px;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      cursor: pointer;
    }
    .error-state-tv .btn-retry:hover {
      background: #1d4ed8;
    }
  </style>
</head>
<body data-tv="1">
  <main id="tv">
    <div class="sponsor-top" id="sponsorTop" hidden></div>
    <div class="stage">
      <iframe id="stage" allow="autoplay; fullscreen" sandbox="allow-scripts allow-same-origin allow-popups allow-forms"></iframe>
      <div id="fallback" class="fallback-card" hidden>
        <h2>âš  Content Unavailable</h2>
        <p id="fallbackMsg">This source cannot be embedded.</p>
        <p class="muted">Switching to next item...</p>
      </div>
    </div>
    <aside id="sponsorSide" hidden></aside>
  </main>
  <div class="toast" id="toast" hidden></div>

  <!-- League & Broadcast Strip (bottom bar for TV) -->
  <div id="leagueBroadcastStrip" class="league-broadcast-strip" hidden>
    <span id="stripTitle" class="strip-title">League & Broadcast</span>
    <div class="strip-divider"></div>
    <div id="leagueLinksSection" class="strip-section" hidden>
      <span class="strip-label">League:</span>
      <div id="leagueStripLinks" class="strip-links"></div>
    </div>
    <div id="broadcastLinksSection" class="strip-section" hidden>
      <span class="strip-label">Broadcast:</span>
      <div id="broadcastStripLinks" class="strip-links"></div>
    </div>
  </div>

  <!-- Legacy League Info Overlay (side column fallback) -->
  <div id="leagueInfoOverlay" class="league-info-overlay" hidden>
    <h3>ðŸ“Š League Info</h3>
    <div id="leagueLinks" class="league-links"></div>
  </div>

  <!-- Trust Footer (subtle for TV) -->
  <footer class="site-footer">
    <span>Powered by <a href="https://eventangle.com" target="_blank" rel="noopener">EventAngle</a></span>
  </footer>

  <script>
    const qs = new URLSearchParams(location.search);
    const eventId = qs.get('event') || qs.get('id') || '';
    const brandId = qs.get('brand') || '<?= brandId ?>';
    const stage = document.getElementById('stage');
    const fallback = document.getElementById('fallback');
    const topEl = document.getElementById('sponsorTop');
    const sideEl = document.getElementById('sponsorSide');
    const mainEl = document.getElementById('tv');
    const toast = document.getElementById('toast');

    const showToast = (msg, ms=2500) => {
      toast.textContent = msg; toast.hidden = false;
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toast.hidden = true, ms);
    };

    // Use shared utilities from SponsorUtils
    const { esc, logEvent, initLogging, getSessionId } = window.SponsorUtils;
    initLogging();

    // Track rendered sponsor IDs for BBN attribution
    let currentRenderedSponsorIds = [];

    // === EVENT_CONTRACT.md v2.0 Support ===
    // Use centralized sectionEnabled from SharedUtils (D-008)
    const sectionEnabled = window.SharedUtils?.sectionEnabled || function(settings, key) {
      if (!settings) return false;
      switch (key) {
        case 'schedule': return settings.showSchedule === true;
        case 'standings': return settings.showStandings === true;
        case 'bracket': return settings.showBracket === true;
        case 'sponsors': return settings.showSponsors === true;
        default: return false;
      }
    };

    // League templates that show the League & Broadcast strip
    const LEAGUE_TEMPLATES = ['rec_league', 'darts', 'bags', 'pinball', 'trivia', 'custom'];

    // Render League & Broadcast strip (ExternalLeagueData per EVENT_CONTRACT.md)
    function renderLeagueBroadcast(templateId, externalData) {
      const ext = externalData || {};

      // Check for league links
      const leagueLinks = [];
      if (ext.scheduleUrl) leagueLinks.push({ icon: 'ðŸ“…', label: 'Schedule', url: ext.scheduleUrl, type: 'schedule' });
      if (ext.standingsUrl) leagueLinks.push({ icon: 'ðŸ†', label: 'Standings', url: ext.standingsUrl, type: 'standings' });
      if (ext.bracketUrl) leagueLinks.push({ icon: 'ðŸŽ¯', label: 'Bracket', url: ext.bracketUrl, type: 'bracket' });

      // Check for broadcast links
      const broadcastLinks = [];
      if (ext.statsUrl) broadcastLinks.push({ icon: 'ðŸ“ˆ', label: 'Stats', url: ext.statsUrl, type: 'stats' });
      if (ext.scoreboardUrl) broadcastLinks.push({ icon: 'ðŸ“º', label: 'Scoreboard', url: ext.scoreboardUrl, type: 'scoreboard' });
      if (ext.streamUrl) broadcastLinks.push({ icon: 'ðŸŽ¥', label: 'Watch', url: ext.streamUrl, type: 'stream', isStream: true });

      const hasLeagueLinks = leagueLinks.length > 0;
      const hasBroadcastLinks = broadcastLinks.length > 0;

      // Only show if we have links AND (is league template OR has explicit data)
      if (!hasLeagueLinks && !hasBroadcastLinks) return;
      if (!LEAGUE_TEMPLATES.includes(templateId) && !hasLeagueLinks && !hasBroadcastLinks) return;

      // Get strip elements
      const strip = document.getElementById('leagueBroadcastStrip');
      const titleEl = document.getElementById('stripTitle');
      const leagueSection = document.getElementById('leagueLinksSection');
      const leagueLinksEl = document.getElementById('leagueStripLinks');
      const broadcastSection = document.getElementById('broadcastLinksSection');
      const broadcastLinksEl = document.getElementById('broadcastStripLinks');

      // Set dynamic title based on providerName
      const providerName = ext.providerName;
      if (providerName && providerName !== 'None' && providerName !== 'Custom') {
        titleEl.textContent = `League & Broadcast (${providerName})`;
      } else {
        titleEl.textContent = 'League & Broadcast';
      }

      // Render league links
      if (hasLeagueLinks) {
        leagueLinksEl.innerHTML = leagueLinks.map(l => `
          <a href="${esc(l.url)}" target="_blank" rel="noopener" class="strip-link" data-link-type="${l.type}">
            <span class="icon">${l.icon}</span>
            <span>${esc(l.label)}</span>
          </a>
        `).join('');
        leagueSection.hidden = false;
      }

      // Render broadcast links
      if (hasBroadcastLinks) {
        broadcastLinksEl.innerHTML = broadcastLinks.map(l => `
          <a href="${esc(l.url)}" target="_blank" rel="noopener" class="strip-link${l.isStream ? ' stream-link' : ''}" data-link-type="${l.type}">
            <span class="icon">${l.icon}</span>
            <span>${esc(l.label)}</span>
          </a>
        `).join('');
        broadcastSection.hidden = false;
      }

      strip.hidden = false;

      // Analytics: log clicks with sponsor attribution (fire-and-forget)
      strip.querySelectorAll('a[data-link-type]').forEach(a => {
        a.addEventListener('click', () => {
          const linkType = a.dataset.linkType;
          NU.rpc('api_logExternalClick', {
            eventId,
            linkType,
            surface: 'display',
            sessionId: getSessionId?.() || '',
            visibleSponsorIds: currentRenderedSponsorIds
          }).catch(() => {});
        });
      });
    }

    // Legacy: Render league info overlay for rec_league template (side column fallback)
    function renderLeagueInfo(templateId, externalData) {
      // Only show for rec_league template (legacy behavior)
      if (templateId !== 'rec_league') return;

      const ext = externalData || {};
      const links = [];

      if (ext.scheduleUrl) {
        links.push({ icon: 'ðŸ“…', label: 'Schedule', url: ext.scheduleUrl });
      }
      if (ext.standingsUrl) {
        links.push({ icon: 'ðŸ†', label: 'Standings', url: ext.standingsUrl });
      }
      if (ext.bracketUrl) {
        links.push({ icon: 'ðŸŽ¯', label: 'Bracket', url: ext.bracketUrl });
      }

      if (!links.length) return;

      const overlay = document.getElementById('leagueInfoOverlay');
      const linksEl = document.getElementById('leagueLinks');

      linksEl.innerHTML = links.map(l => `
        <a href="${esc(l.url)}" target="_blank" rel="noopener" class="league-link">
          <span class="icon">${l.icon}</span>
          <span>${esc(l.label)}</span>
        </a>
      `).join('');

      overlay.hidden = false;
    }

    // NOTE: Legacy renderSponsor* functions removed in E-003
    // All sponsor rendering now uses SponsorUtils.SponsorRenderer

    function startPublicMode() {
      const base = location.origin + location.pathname;
      const tvPublicUrl = `${base}?p=public&brand=${encodeURIComponent(brandId)}&id=${encodeURIComponent(eventId)}&tv=1`;
      loadIframe(tvPublicUrl);
      showToast('TV: Public mode (mirroring event page)');
    }

    function loadIframe(url, onFail) {
      fallback.hidden = true;
      stage.hidden = false;
      stage.src = url;

      // Detect iframe load errors (blocked embed, 404, etc.)
      let loaded = false;
      const checkLoad = () => {
        try {
          // If same-origin, we can check; if cross-origin with errors, this will fail
          const doc = stage.contentDocument || stage.contentWindow?.document;
          if (doc && doc.readyState === 'complete') loaded = true;
        } catch (_) {
          // Cross-origin, assume it's loading unless we timeout
        }
      };

      stage.onload = () => { loaded = true; checkLoad(); };
      stage.onerror = () => {
        showFallback(url);
        if (onFail) onFail();
      };

      // Fallback timeout: if not loaded in 4s, assume blocked
      setTimeout(() => {
        if (!loaded) {
          showFallback(url);
          if (onFail) onFail();
        }
      }, 4000);
    }

    function showFallback(url) {
      stage.hidden = true;
      fallback.hidden = false;
      document.getElementById('fallbackMsg').textContent = `Cannot embed: ${url.slice(0, 60)}...`;
      logEvent({ eventId, surface: 'display', metric: 'blocked_embed', value: 1 });
    }

    function startDynamicMode(urls) {
      if (!urls || !urls.length) return startPublicMode();
      let idx = -1;

      const next = () => {
        idx = (idx + 1) % urls.length;
        const it = urls[idx] || {};
        const url = String(it.url || '').trim();
        const sec = Math.max(5, Number(it.seconds || it.sec || it.duration || 10));

        if (!url) return setTimeout(next, 200);

        // Skip known restricted embeds (Instagram, etc.) silently
        const lower = url.toLowerCase();
        if (lower.includes('instagram.com') || lower.includes('tiktok.com')) {
          console.log(`Skipping restricted embed: ${url}`);
          return setTimeout(next, 500);
        }

        showToast(`TV: Dynamic ${idx + 1}/${urls.length} Â· ${sec}s`);

        logEvent({ eventId, surface: 'display', metric: 'impression' });
        logEvent({ eventId, surface: 'display', metric: 'dwellSec', value: sec });

        loadIframe(url, () => {
          // If blocked, skip to next after 2s (no error display, just skip)
          setTimeout(next, 2000);
        });

        clearTimeout(startDynamicMode._t);
        startDynamicMode._t = setTimeout(next, sec * 1000);
      };
      next();
    }

    /**
     * Boot Display.html
     * EVENT_CONTRACT.md v2.0: Uses api_getDisplayBundle for TV-optimized data
     *
     * DisplayBundle returns:
     * - event: Full canonical Event shape
     * - rotation: { sponsorSlots, rotationMs }
     * - layout: { hasSidePane, emphasis }
     */
    async function boot() {
      if (!eventId) return startPublicMode();

      const res = await NU.rpc('api_getDisplayBundle', { brandId, scope: 'events', id: eventId });
      if (!res?.ok || !res?.value) return startPublicMode();

      const bundle = res.value;
      const ev = bundle.event || {};
      const rotation = bundle.rotation || {};
      const layout = bundle.layout || {};

      // === LOG DISPLAY VIEW METRIC ===
      logEvent({ eventId: ev.id, surface: 'display', metric: 'view', value: 1 });

      // === CONTRACT FIELDS (MVP REQUIRED) ===
      const settings = ev.settings || { showSchedule: false, showStandings: false, showBracket: false, showSponsors: false };

      // === CONTRACT FIELDS (V2 OPTIONAL) ===
      const sponsors = ev.sponsors || [];
      const externalData = ev.externalData || {};

      // === LEGACY DATA FOR DYNAMIC MODE ===
      const legacyData = ev.data || {};
      const displayConfig = legacyData.display || {};

      // === RENDER LEAGUE & BROADCAST STRIP ===
      // Uses event.externalData (V2 Optional)
      if (externalData.scheduleUrl || externalData.standingsUrl || externalData.bracketUrl ||
          externalData.statsUrl || externalData.scoreboardUrl || externalData.streamUrl) {
        renderLeagueBroadcast(ev.templateId || '', externalData);
      }

      // === RESERVED SPONSOR STRIP ===
      // Uses event.settings.showSponsors and event.sponsors
      if (settings.showSponsors && sponsors.length > 0) {
        // Filter sponsors by placement for display/tv-banner
        const displaySponsors = sponsors.filter(s =>
          s.placement === 'display' || s.placement === 'tv-banner' || !s.placement
        );
        if (displaySponsors.length > 0) {
          // Use unified SponsorRenderer from SponsorUtils
          const { SponsorRenderer } = window.SponsorUtils;
          SponsorRenderer.renderStrip({
            container: topEl,
            sponsors: displaySponsors,
            eventId: ev.id,
            surface: 'display',
            showTier: true,
            onRender: ids => { currentRenderedSponsorIds = [...new Set([...currentRenderedSponsorIds, ...ids])]; }
          });
          // Use layout.hasSidePane from DisplayBundle to show side panel
          if (layout.hasSidePane) {
            SponsorRenderer.renderGrid({
              container: sideEl,
              sponsors: displaySponsors,
              eventId: ev.id,
              surface: 'display',
              mainEl: mainEl,
              onRender: ids => { currentRenderedSponsorIds = [...new Set([...currentRenderedSponsorIds, ...ids])]; }
            });
          }
        }
      }

      // === START DISPLAY MODE ===
      // Dynamic mode: rotate through configured URLs
      // Public mode: mirror the event public page
      if (String(displayConfig.mode || '').toLowerCase() === 'dynamic'
          && Array.isArray(displayConfig.urls) && displayConfig.urls.length) {
        startDynamicMode(displayConfig.urls);
      } else {
        startPublicMode();
      }
    }

    /**
     * Render event info header for TV
     * Uses: event.name, event.startDateISO, event.venue
     */
    function renderEventInfo(name, startDateISO, venue) {
      // Event info is shown in the sponsor top bar area if no sponsors
      // For now we'll just log it - the public mode iframe shows this
      console.log('Display: Event info', { name, startDateISO, venue });
    }

    /**
     * Render schedule panel for TV (MVP Optional)
     * Uses: event.schedule per EVENT_CONTRACT.md
     */
    function renderSchedulePanel(schedule) {
      // For MVP, schedule is shown in the embedded public page
      // Future: Dedicated TV schedule overlay
      console.log('Display: Schedule panel', schedule.length, 'items');
    }

    /**
     * Render standings panel for TV (MVP Optional)
     * Uses: event.standings per EVENT_CONTRACT.md
     */
    function renderStandingsPanel(standings) {
      // For MVP, standings is shown in the embedded public page
      // Future: Dedicated TV standings overlay
      console.log('Display: Standings panel', standings.length, 'rows');
    }

    /**
     * Render bracket panel for TV (MVP Optional)
     * Uses: event.bracket per EVENT_CONTRACT.md
     */
    function renderBracketPanel(bracket) {
      // For MVP, bracket is shown in the embedded public page
      // Future: Dedicated TV bracket overlay
      console.log('Display: Bracket panel', bracket?.rounds?.length || 0, 'rounds');
    }

    boot();
  </script>
</body>
</html>
