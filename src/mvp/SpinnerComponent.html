<!--
================================================================================
SpinnerComponent - Unified Loading Indicators
================================================================================
Extracted from: Styles.html spinner + loading patterns across pages
Purpose: Consistent loading states across all MVP surfaces

Usage:
  include('SpinnerComponent')

Then use classes:
  - .spinner: Standalone spinner animation
  - .loading-state: Full loading container with spinner + text
  - .spinner-inline: Small inline spinner for buttons
  - .btn-loading: Button loading state

DO NOT modify this component without updating:
  - All MVP surfaces that use loading states
  - Design system documentation
================================================================================
-->
<style>
  /* ===== Spinner Animation ===== */
  @keyframes spinner-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Base Spinner */
  .spinner {
    width: 40px;
    height: 40px;
    border: 4px solid var(--color-gray-200, #e2e8f0);
    border-top-color: var(--color-primary, #2563eb);
    border-radius: 50%;
    animation: spinner-rotate 1s linear infinite;
  }

  /* Small Spinner (for inline use) */
  .spinner-sm {
    width: 20px;
    height: 20px;
    border-width: 2px;
  }

  /* Large Spinner (for full-page loading) */
  .spinner-lg {
    width: 60px;
    height: 60px;
    border-width: 5px;
  }

  /* Inline Spinner (for buttons/text) */
  .spinner-inline {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid currentColor;
    border-top-color: transparent;
    border-radius: 50%;
    animation: spinner-rotate 0.8s linear infinite;
    vertical-align: middle;
    margin-right: 6px;
  }

  /* ===== Loading State Container ===== */
  .loading-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--space-8, 2rem);
    text-align: center;
    color: var(--color-gray-500, #64748b);
    min-height: 200px;
  }

  .loading-state .spinner {
    margin-bottom: var(--space-4, 1rem);
  }

  .loading-state p {
    margin: 0;
    font-size: var(--font-size-sm, 0.875rem);
  }

  /* Compact Loading State */
  .loading-state.compact {
    min-height: 100px;
    padding: var(--space-4, 1rem);
  }

  .loading-state.compact .spinner {
    width: 30px;
    height: 30px;
    border-width: 3px;
  }

  /* ===== Button Loading State ===== */
  .btn-loading {
    position: relative;
    pointer-events: none;
    opacity: 0.8;
  }

  .btn-loading .btn-text {
    visibility: hidden;
  }

  .btn-loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 18px;
    height: 18px;
    margin-top: -9px;
    margin-left: -9px;
    border: 2px solid currentColor;
    border-top-color: transparent;
    border-radius: 50%;
    animation: spinner-rotate 0.8s linear infinite;
  }

  /* ===== Skeleton Loading ===== */
  .skeleton {
    background: linear-gradient(
      90deg,
      var(--color-gray-100, #f1f5f9) 25%,
      var(--color-gray-200, #e2e8f0) 50%,
      var(--color-gray-100, #f1f5f9) 75%
    );
    background-size: 200% 100%;
    animation: skeleton-shimmer 1.5s ease-in-out infinite;
    border-radius: var(--radius-sm, 6px);
  }

  @keyframes skeleton-shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  .skeleton-text {
    height: 1em;
    margin-bottom: 0.5em;
  }

  .skeleton-text:last-child {
    width: 70%;
  }

  .skeleton-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
  }

  .skeleton-card {
    height: 120px;
  }

  /* ===== Reduced Motion Support ===== */
  @media (prefers-reduced-motion: reduce) {
    .spinner,
    .spinner-inline,
    .btn-loading::after {
      animation-duration: 1.5s;
    }

    .skeleton {
      animation: none;
      background: var(--color-gray-200, #e2e8f0);
    }
  }
</style>

<script>
/**
 * SpinnerUtils - Programmatic loading state helpers
 */
window.SpinnerUtils = (function() {
  'use strict';

  /**
   * Set button to loading state
   * @param {HTMLButtonElement} button - Button element
   * @param {boolean} loading - Whether to show loading state
   */
  function setButtonLoading(button, loading = true) {
    if (!button) return;

    if (loading) {
      button.classList.add('btn-loading');
      button.disabled = true;
      button.dataset.originalText = button.innerHTML;
      const textSpan = button.querySelector('.btn-text');
      if (textSpan) textSpan.style.visibility = 'hidden';
    } else {
      button.classList.remove('btn-loading');
      button.disabled = false;
      if (button.dataset.originalText) {
        button.innerHTML = button.dataset.originalText;
        delete button.dataset.originalText;
      }
    }
  }

  /**
   * Create a spinner element
   * @param {string} size - 'sm', 'md', 'lg'
   * @returns {HTMLElement} Spinner element
   */
  function createSpinner(size = 'md') {
    const spinner = document.createElement('div');
    spinner.className = 'spinner';
    if (size === 'sm') spinner.classList.add('spinner-sm');
    if (size === 'lg') spinner.classList.add('spinner-lg');
    spinner.setAttribute('role', 'status');
    spinner.setAttribute('aria-label', 'Loading');
    return spinner;
  }

  /**
   * Create a full loading state container
   * @param {string} message - Loading message
   * @returns {HTMLElement} Loading state element
   */
  function createLoadingState(message = 'Loading...') {
    const container = document.createElement('div');
    container.className = 'loading-state';
    container.innerHTML = `
      <div class="spinner" role="status" aria-label="Loading"></div>
      <p>${message}</p>
    `;
    return container;
  }

  return {
    setButtonLoading,
    createSpinner,
    createLoadingState
  };
})();
</script>
