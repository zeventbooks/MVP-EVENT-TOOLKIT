{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://eventangle.com/schemas/status.schema.json",
  "title": "Status Response",
  "description": "Canonical status endpoint response contract for health checks and monitoring. This is the single source of truth for BUILD_ID and BRAND_ID. External uptime / SLO is measured via ?p=status.",
  "type": "object",
  "required": ["ok", "buildId", "brandId", "time"],
  "additionalProperties": false,
  "properties": {
    "ok": {
      "type": "boolean",
      "description": "Health status. True if the service is operational and responding correctly."
    },
    "buildId": {
      "type": "string",
      "minLength": 1,
      "maxLength": 64,
      "pattern": "^[a-zA-Z0-9._-]+$",
      "description": "Build identifier (e.g., 'mvp-v19'). Used for deployment verification and cache busting.",
      "examples": ["mvp-v19", "mvp-v20"]
    },
    "brandId": {
      "type": "string",
      "minLength": 1,
      "maxLength": 32,
      "pattern": "^[a-z0-9_-]+$",
      "description": "Brand identifier for multi-tenant support (e.g., 'root', 'abc', 'cbc', 'cbl').",
      "examples": ["root", "abc", "cbc", "cbl"]
    },
    "time": {
      "type": "string",
      "format": "date-time",
      "description": "Server timestamp in ISO 8601 format."
    },
    "db": {
      "type": "object",
      "description": "Optional database/datastore health status.",
      "required": ["ok"],
      "additionalProperties": false,
      "properties": {
        "ok": {
          "type": "boolean",
          "description": "True if the backend datastore (spreadsheet) is accessible."
        }
      }
    },
    "message": {
      "type": "string",
      "maxLength": 500,
      "description": "Optional message when ok=false, explaining the error condition."
    }
  },
  "examples": [
    {
      "ok": true,
      "buildId": "mvp-v19",
      "brandId": "root",
      "time": "2025-11-28T12:00:00.000Z",
      "db": { "ok": true }
    },
    {
      "ok": false,
      "buildId": "mvp-v19",
      "brandId": "unknown",
      "time": "2025-11-28T12:00:00.000Z",
      "db": { "ok": false },
      "message": "Brand not found: invalid"
    }
  ]
}
